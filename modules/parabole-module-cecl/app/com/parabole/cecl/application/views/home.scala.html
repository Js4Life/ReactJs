<div ng-controller="homeCtrl">
  <div class="panel panel-default">
    <div class="panel-heading" style="padding-bottom:9px" >
      <b>{{heading.title}}</b> ({{currentRegulation}}<span ng-show="currentRegulationFile">: {{currentRegulationFile}}</span>)
      <div ng-show="childNodes.length > 0" class="right-inner-addon" style="display:inline-block;width:25%;margin-left:20px;">
        <i class="glyphicon glyphicon-search"></i>
        <input type="search" class="form-control input-sm" placeholder="Search from {{childNodes.length || 'following'}} items..." ng-model="searchText" />
      </div>
      <div class="btn-group pull-right" role="group">
        @*<span ng-click="leftSlideToggle()" class="fa fa-expand pull-right" tooltip='"title":"Fullscreen"'></span>*@
        <button ng-if="isGridView" type="button" class="btn btn-xs" ng-click="toggleView()">
          <i class="fa fa-th-list" aria-hidden="true"></i>
        </button>
        <button ng-if="!isGridView" type="button" class="btn btn-xs" ng-click="toggleView()">
          <i class="fa fa-th-large" aria-hidden="true"></i>
        </button>
        <div class="btn-group pull-right" role="group">
            <button class="btn btn-xs dropdown-toggle" type="button" data-toggle="dropdown">
                <i class="fa fa-cog" aria-hidden="true"></i>
                <span class="caret"></span>
            </button>
            <ul class="dropdown-menu" aria-labelledby="dLabel">
                <li class="pointer" ng-click="startContentParser()"><a><i class="fa fa-file-pdf-o"></i> Document Parser</a></li>
                <li class="pointer" ng-click="startOntologyParser()"><a><i class="fa fa-share-alt"></i> Ontology Parser</a></li>
            </ul>
        </div>
      </div>
    </div>
    <div class="panel-body zero-padding">
      <div panel panel-default>
        <div class="panel-body" style="padding:0;">
          <div ng-class="collapseClasses.left" style="overflow-y:auto;height:80vh;">
            <ul class="list-group">
              <li class="list-group-item pointer puff" ng-class="{'active-nav': node.name === 'Concept'}" ng-repeat="node in nodes" ng-click="exploreNode(node , $event)">
                {{node.name}}
              </li>
            </ul>
          </div>
          <div class="zero-padding" ng-class="collapseClasses.center" style="cursor:hand;height:81vh;overflow: auto;">
              <ol class="breadcrumb" ng-if="breads.length > 0">
                  <li class="pointer" ng-repeat="bread in breads" ng-click="onBreadClick(bread)" onmouseover='this.style.color="blue"' onmouseout='this.style.color="black"'>{{bread.name}}</li>
                  <div class="btn-group btn-group-xs pull-right" data-toggle="buttons">
                    <label class="btn btn-primary" ng-click="setColorCode('all')">
                      <input type="radio" name="options" id="option1" autocomplete="off"> All
                    </label>
                    <label class="btn btn-danger" ng-click="setColorCode('red')">
                      <input type="radio" name="options" id="option1" autocomplete="off"> <i class="fa fa-dot-circle-o" aria-hidden="true"></i>
                    </label>
                    <label class="btn btn-warning" ng-click="setColorCode('amber')">
                      <input type="radio" name="options" id="option2" autocomplete="off"> <i class="fa fa-dot-circle-o" aria-hidden="true"></i>
                    </label>
                    <label class="btn btn-success" ng-click="setColorCode('green')">
                      <input type="radio" name="options" id="option3" autocomplete="off"> <i class="fa fa-dot-circle-o" aria-hidden="true"></i>
                    </label>
                    <label class="btn btn-default" ng-click="setColorCode('gray')">
                      <input type="radio" name="options" id="option3" autocomplete="off"> <i class="fa fa-dot-circle-o" aria-hidden="true"></i>
                    </label>
                  </div>
              </ol>
              <div ng-if="isGridView">
                  <div ng-if="currentColorCode === child.colorCode || currentColorCode === 'all'" class="col-md-2" ng-repeat="child in childNodes | orderBy : 'name' | filter: searchText" index="{{$index}}">
                    <div class="panel panel-default" style="box-shadow: 1px 2px 7px #d8d8d8;">
                      <div class="panel-body text-center zero-padding" ng-class="getComplianceColorcode(child)">
                          <div ng-if="child.type === 'PARAGRAPH' || child.type === 'BASELPARAGRAPH'" class="para-ribbon"></div>
                          <div style="font-weight: bold;font-size: 2.5em;opacity:0.4;">{{child.name.charAt(0)}}</div>
                          <div class="pointer" style="position:absolute;right:20px;top:5px;font-weight: bold;" ng-click="getChecklistByNode(child)">{{child.compliance || 0}}%</div>
                      </div>
                      <div ng-click="exploreNode(child.type, child.elementID)" class="panel-footer ellipsis-text pointer" tooltip='"title":"{{child.name}}"'>{{child.name}}</div>
                    </div>
                  </div>
              </div>
              <table ng-if="!isGridView" class="table table-condensed">
                  <thead>
                      <th>Status</th><th>{{breads[breads.length-1].name}}</th><th>Compliance</th><th></th>
                  </thead>
                  <tbody>
                      <tr ng-if="currentColorCode === child.colorCode || currentColorCode === 'all'" ng-repeat="child in childNodes | orderBy : 'name' | filter: searchText" index="{{$index}}">
                          <td><i class="fa fa-circle" aria-hidden="true" ng-class="getComplianceColorcode(child)"></i></td>
                          <td>{{child.name}}</td>
                          <td class="pointer" ng-click="getChecklistByNode(child)">{{child.compliance || 0}}%</td>
                          <td><i class="fa fa-eye" aria-hidden="true" ng-click="exploreNode(child.type, child.elementID)"></i></td>
                      </tr>
                  </tbody>
              </table>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="checklistModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
          <h4 class="modal-title" id="myModalLabel">{{currentNode.name}}&nbsp; <span ng-if="!showLimited">({{currentNode.compliance}}% Compliant)</span></h4>
        </div>
        <div ng-if="!showLimited" class="modal-header zero-padding" ng-class="getComplianceColorcode(currentNode)"></div>
        <div class="modal-body zero-padding-bottom" style="height: 66vh; overflow: auto;">
          <ul class="list-group">
            <li class="list-group-item" ng-repeat="c in checkList">
              <input ng-if="!showLimited" type="checkbox" ng-model="answers[c.id]" style="position: relative;top: 2px;"/>&nbsp;{{c.bodyText}}
            </li>
          </ul>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-default" ng-click="viewChecklistDetails()">Details</button>
          <button ng-if="!showLimited" type="button" class="btn btn-default" ng-click="saveAnswers()">Save</button>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade bs-example-modal-lg" id="checklistDetailsModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" style="width:92%;">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
          <h4 class="modal-title" id="myModalLabel">{{currentNode.name}}</h4>
        </div>
        <div class="modal-body zero-padding-bottom">
          <div ui-grid="gridOptions" ui-grid-exporter ui-grid-resize-columns ui-grid-move-columns style="height:65vh;"></div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-default" ng-click="exportCsv()">CSV</button>
        </div>
      </div>
    </div>
  </div>
</div>